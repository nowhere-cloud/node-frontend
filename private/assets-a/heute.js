"use strict";var map={action:{"set.vm.power_on":"Power On","set.vm.power_off":"Power Off","set.vm.power_reboot":"Reboot","set.vm.power_suspend":"Suspend","set.vm.power_resume":"Resume","do.vm.destroy":"Destroy"}},babel=function(e,i){return map[e][i]?map[e][i]:"!!! "+e+"=>"+i+" !!!"};!function(e){var i=e("p#uuid").html().trim(),t="",a=e("<span/>").addClass("text-danger"),o=function(){e.get("../api/vm/"+i+"/metrics").done(function(i){"Success"===i.Status?(e("#modal-metric-osname").html(i.Value.os_version.name),e("#modal-metric-kernel").html(i.Value.os_version.uname),e("#modal-metric-driver").html(i.Value.PV_drivers_version.major+"."+i.Value.PV_drivers_version.minor+"."+i.Value.PV_drivers_version.micro+" build "+i.Value.PV_drivers_version.build),e("#modal-ip-ipv4").html(i.Value.networks["0/ip"]),e("#modal-ip-ipv6").html(i.Value.networks["0/ipv6/0"]),"Running"!==e("dd#pstate").html()&&e("#modal-ip-alert").removeClass("invisible")):(a.html("Contact Administrator: "+i.ErrorDescription).addClass("col-sm-12"),e("#modal-metric-main").html(a),e("#modal-ip-main").html(a))}).fail(function(i){a.html(i.status+" "+i.statusText),e("#modal-metric-main").html(a),e("#modal-ip-main").html(a)})},s=function(){e.get("../api/vm/"+i+"/pstate").done(function(i){"Success"===i.Status?(e("#pstate").html(i.Value.power_state),e.each(i.Value.allowed_operations,function(i,t){switch(t){case"start":e('[data-action="set.vm.power_on"]').removeClass("invisible");break;case"hard_shutdown":e('[data-action="set.vm.power_off"]').removeClass("invisible");break;case"hard_reboot":e('[data-action="set.vm.power_reboot"]').removeClass("invisible");break;case"suspend":e('[data-action="set.vm.power_suspend"]').removeClass("invisible");break;case"resume":e('[data-action="set.vm.power_resume"]').removeClass("invisible");break;case"clone":e('[data-action="do.vm.clone"]').removeClass("invisible");break;case"destroy":e('[data-action="do.vm.destroy"]').removeClass("invisible")}})):(a.html("Contact Administrator: "+i.ErrorDescription),e("#pstate").html(a))}).fail(function(i){a.html(i.status+" "+i.statusText),e("#pstate").html(a)})},n=function(t,a,o){e.ajax({type:"POST",url:"../api/vm/"+i+"/send",data:{_csrf:o,action:t,payload:a},success:function(i,t,a){e("#confirmation-loading").addClass("invisible"),e("#confirmation-field-rsvp-etktid").html(i.task),e("#confirmation-field-rsvp").removeClass("invisible"),setTimeout(function(){e("#confirmation-modal").modal("hide"),e(".vm-actions").addClass("invisible")},1e4)},dataType:"json"})};e(document).ready(function(){setTimeout(function(){s()},1e3),setTimeout(function(){o()},1500)}),e("#refresh").on("click",function(){e("#modal-ip-alert").addClass("invisible"),setTimeout(function(){e(".vm-actions").addClass("invisible"),s()},1e3),setTimeout(function(){o()},2e3)}),e("#managed-tool").on("click",".vm-actions",function(){t=e(this).data("action"),e("#confirmation-field-uuid").html(i),e("#confirmation-field-verb").html(babel("action",t)),"do.vm.clone"===t?window.location.href="clone?t="+i:e("#confirmation-modal").modal("show")}),e("#confirmation-confirm").on("click",function(){n(t,{},e(this).data("csrf")),e("#confirmation-loading").removeClass("invisible"),e(this).addClass("invisible")})}(jQuery);